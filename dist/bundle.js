(()=>{"use strict";var t,e=function(){function t(t,e,n,r){this.templateElement=document.getElementById(t),this.hostElement=document.getElementById(e),this.element=this.importTemplateContent().firstElementChild,this.attachTemplateElement(n)}return t.prototype.importTemplateContent=function(){return document.importNode(this.templateElement,!0).content},t.prototype.attachTemplateElement=function(t){this.hostElement.insertAdjacentElement(t?"afterbegin":"beforeend",this.element)},t}();function n(t,e,n){var r=n.value;return{configurable:!0,get:function(){return r.bind(this)}}}!function(t){t[t.ACTIVE=0]="ACTIVE",t[t.FINISHED=1]="FINISHED"}(t||(t={}));var r,o=function(t,e,n,r){this.title=t,this.description=e,this.people=n,this.status=r,this.id=(Math.random()+Date.now()).toString()},i=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(e){function n(){var t=e.call(this)||this;return t.projects=[],t}return i(n,e),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},n.prototype.addProject=function(e,n,r){var i=new o(e,n,r,t.ACTIVE);this.projects.push(i),this.updateListeners()},n.prototype.updateListeners=function(){for(var t=0,e=this.listeners;t<e.length;t++)(0,e[t])(this.projects.slice())},n.prototype.moveProject=function(t,e){var n=this.projects.filter((function(e){return e.id===t}))[0];n&&n.status!==e&&(n.status=e,this.updateListeners())},n}(function(){function t(){this.listeners=[]}return t.prototype.addListener=function(t){this.listeners.push(t)},t}()).getInstance(),c=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(){var e=t.call(this,"project-input","app",!0)||this;return e.titleInput=e.element.querySelector("#title"),e.descriptionInput=e.element.querySelector("#description"),e.peopleInput=e.element.querySelector("#people"),e.configure(),e}return c(e,t),e.prototype.configure=function(){this.element.addEventListener("submit",this.sumbitHandler)},e.prototype.sumbitHandler=function(t){t.preventDefault();var e=this.validateFormData();if(Array.isArray(e)){var n=e[0],r=e[1],o=e[2];a.addProject(n,r,o),this.clearAll()}},e.prototype.renderContent=function(){},e.prototype.validateFormData=function(){var t=this.titleInput.value.trim(),e=this.descriptionInput.value.trim(),n=+this.peopleInput.value,r={required:!0,value:t,minLength:3,maxLength:50},o={required:!0,value:e,minLength:10,maxLength:100},i={required:!0,value:n,max:6};if(this.isFormValid([r,o,i]))return[t,e,+n];alert("Form not valid")},e.prototype.isFormValid=function(t){return t.every((function(t){return function(t){var e=!0;return t.required&&(e=e&&0!==t.value.toString().length),"maxLength"in t&&void 0!==t.maxLength&&(e=e&&t.value.toString().length<t.maxLength),"minLength"in t&&void 0!==t.minLength&&(e=e&&t.value.toString().length>t.minLength),"max"in t&&void 0!==t.max&&(e=e&&t.value<t.max),"min"in t&&void 0!==t.min&&(e=e&&t.value>t.min),e}(t)}))},e.prototype.clearAll=function(){this.titleInput.value="",this.descriptionInput.value="",this.peopleInput.value=""},function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);i>3&&a&&Object.defineProperty(e,n,a)}([n],e.prototype,"sumbitHandler",null),e}(e),l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},u=function(t){function e(e,n){var r=t.call(this,"single-project",e,!1,n.id)||this;return r.project=n,r.configure(),r.renderContent(),r}return l(e,t),Object.defineProperty(e.prototype,"persons",{get:function(){return 1===this.project.people?"1 person":"".concat(this.project.people," persons")},enumerable:!1,configurable:!0}),e.prototype.dragStartHandler=function(t){t.dataTransfer.setData("text/plain",this.project.id),t.dataTransfer.effectAllowed="move"},e.prototype.dragEndHandler=function(t){},e.prototype.renderContent=function(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assgined",this.element.querySelector("p").textContent=this.project.description},e.prototype.configure=function(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)},p([n],e.prototype,"dragStartHandler",null),p([n],e.prototype,"dragEndHandler",null),e}(e),f=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},h=function(e){function r(t){var n=e.call(this,"project-list","app",!1,"".concat(t,"-projects"))||this;return n.type=t,n.assignedProjects=[],n.element.id="".concat(n.type,"-projects"),n.configure(),n.renderContent(),n}return f(r,e),r.prototype.dragOverHandler=function(t){t.dataTransfer&&"text/plain"===t.dataTransfer.types[0]&&(console.log(t.dataTransfer.getData("text/plain")),t.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))},r.prototype.dropHandler=function(e){var n=e.dataTransfer.getData("text/plain");a.moveProject(n,"active"===this.type?t.ACTIVE:t.FINISHED)},r.prototype.dragLeaveHandler=function(t){this.element.querySelector("ul").classList.remove("droppable")},r.prototype.renderProjects=function(){var t=this.element.querySelector("#".concat(this.type,"-projects-list"));t.innerHTML="";for(var e=0,n=this.assignedProjects;e<n.length;e++){var r=n[e];new u(t.id,r)}},r.prototype.renderContent=function(){this.element.querySelector("h2").textContent=this.type.toUpperCase()+" Projects"},r.prototype.configure=function(){var e=this;this.element.querySelector("ul").id="".concat(this.type,"-projects-list"),this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),a.addListener((function(n){var r=n.filter((function(n){return"active"===e.type?n.status===t.ACTIVE:n.status===t.FINISHED}));e.assignedProjects=r,e.renderProjects()}))},d([n],r.prototype,"dragOverHandler",null),d([n],r.prototype,"dropHandler",null),d([n],r.prototype,"dragLeaveHandler",null),r}(e);new s,new h("active"),new h("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFhcUIsYUFBWSxTQUFDcEIsR0FDdEIsSUFBTW1GLEVBQW1CbkYsRUFBU2tCLFFBQU8sU0FBQ0QsR0FDdEMsTUFBaUIsV0FBZCxFQUFLZ0QsS0FDR2hELEVBQVF6QixTQUFXN0IsRUFBYzZDLE9BRXJDUyxFQUFRekIsU0FBVzdCLEVBQWNnSCxZQUU1QyxFQUFLVCxpQkFBbUJpQixFQUN4QixFQUFLTCxxQkFsRGIsR0FEQ2xHLEcsb0NBV0QsR0FEQ0EsRyxnQ0FRRCxHQURDQSxHLHFDQXFDTCxFQWpFQSxDQUFpQzZFLEdDSnJDLElBQUkyQixFQUNKLElBQUlDLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxhIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhZy1hbmQtZHJvcC8uL3NyYy9jb21wb25lbnRzL2Jhc2UudHMiLCJ3ZWJwYWNrOi8vZHJhZy1hbmQtZHJvcC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9kcmFnLWFuZC1kcm9wLy4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vZHJhZy1hbmQtZHJvcC8uL3NyYy9zdGF0ZS9wcm9qZWN0LnRzIiwid2VicGFjazovL2RyYWctYW5kLWRyb3AvLi9zcmMvY29tcG9uZW50cy91c2VySW5wdXQudHMiLCJ3ZWJwYWNrOi8vZHJhZy1hbmQtZHJvcC8uL3NyYy91dGlscy92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL2RyYWctYW5kLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vZHJhZy1hbmQtZHJvcC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly9kcmFnLWFuZC1kcm9wLy4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIgICAgXHJcbiAgICBleHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50IDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD57XHJcbiAgICAgICAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgICAgIGhvc3RFbGVtZW50OiBUO1xyXG4gICAgICAgIGVsZW1lbnQ6IFU7XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKHRlbXBJZDogc3RyaW5nLCBob3N0SWQ6IHN0cmluZywgaXNBZnRlclN0YXJ0OiBib29sZWFuLCBlbGVtZW50SWQ/OiBzdHJpbmcpe1xyXG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXMuaG9zdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChob3N0SWQpISBhcyBUO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmltcG9ydFRlbXBsYXRlQ29udGVudCgpLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmF0dGFjaFRlbXBsYXRlRWxlbWVudChpc0FmdGVyU3RhcnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBpbXBvcnRUZW1wbGF0ZUNvbnRlbnQoKXtcclxuICAgICAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWxlbWVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbXBvcnRlZE5vZGUuY29udGVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByaXZhdGUgYXR0YWNoVGVtcGxhdGVFbGVtZW50KGlzQWZ0ZXJTdGFydDogYm9vbGVhbil7XHJcbiAgICAgICAgICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KGlzQWZ0ZXJTdGFydCA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG4gICAgICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gICAgfSIsIiAgICAgICAgXHJcbi8vIFR5cGVzXHJcbmV4cG9ydCBlbnVtIFByb2plY3RTdGF0dXMge0FDVElWRSwgRklOSVNIRUR9O1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdHtcclxuICAgIGlkOiBzdHJpbmcgO1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIHRpdGxlOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcclxuICAgICl7XHJcbiAgICAgICAgdGhpcy5pZCA9IChNYXRoLnJhbmRvbSgpICsgRGF0ZS5ub3coKSkudG9TdHJpbmcoKTtcclxuICAgIH1cclxufSIsIiAgICBleHBvcnQgZnVuY3Rpb24gYXV0b0JpbmQoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3Ipe1xyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAgICAgICBjb25zdCBhZGp1c3RlZERlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBnZXQoKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHJldHVybiBhZGp1c3RlZERlc2NyaXB0b3I7XHJcbiAgICB9IiwiICAgIGltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuICAgIGltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuICAgIHR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcbiAgICBjbGFzcyBTdGF0ZTxUPiB7XHJcbiAgICAgICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xyXG5cclxuICAgICAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lcjogTGlzdGVuZXI8VD4pe1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD57XHJcbiAgICAgICAgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xyXG4gICAgICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XHJcbiAgICAgICAgcHJpdmF0ZSBjb25zdHJ1Y3RvciAoKXtcclxuICAgICAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhdGljIGdldEluc3RhbmNlKCl7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaW5zdGFuY2Upe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcsIHBlb3BsZTogbnVtYmVyKXtcclxuICAgICAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUsIFByb2plY3RTdGF0dXMuQUNUSVZFKTtcclxuICAgICAgICAgICAgdGhpcy5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdXBkYXRlTGlzdGVuZXJzKCl7XHJcbiAgICAgICAgICAgIGZvcihjb25zdCBsaXN0ZW5lciBvZiB0aGlzLmxpc3RlbmVycyl7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcih0aGlzLnByb2plY3RzLnNsaWNlKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBtb3ZlUHJvamVjdChwcm9qZWN0SUQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKXtcclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmlsdGVyKChwcm9qOlByb2plY3QpID0+IHByb2ouaWQgPT09IHByb2plY3RJRClbMF07XHJcbiAgICAgICAgICAgIGlmKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cyl7XHJcbiAgICAgICAgICAgICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpOyIsIlxyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlXCI7XHJcbmltcG9ydCB7IGF1dG9CaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcclxuaW1wb3J0IHsgU3RyaW5nVmFsaWR0YWJsZSwgTnVtYmVyVmFsaWR0YWJsZSwgdmFsaWRhdGVWYWx1ZSB9IGZyb20gXCIuLi91dGlscy92YWxpZGF0aW9uXCI7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9wcm9qZWN0XCI7XHJcbiAgICBleHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcclxuXHJcbiAgICAgICAgdGl0bGVJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBkZXNjcmlwdGlvbklucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHBlb3BsZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgXHJcbiAgICAgICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSk7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy50aXRsZUlucHV0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZScpISBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykhIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIHRoaXMucGVvcGxlSW5wdXQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpISBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJlKClcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgIGNvbmZpZ3VyZSgpe1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLnN1bWJpdEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIEBhdXRvQmluZFxyXG4gICAgICAgIHByaXZhdGUgc3VtYml0SGFuZGxlcihldmVudDogRXZlbnQpe1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyRGF0YSA9IHRoaXMudmFsaWRhdGVGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICBpZihBcnJheS5pc0FycmF5KHVzZXJEYXRhKSl7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VyRGF0YTtcclxuICAgICAgICAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgcmVuZGVyQ29udGVudCgpe31cclxuICAgIFxyXG4gICAgICAgIHByaXZhdGUgdmFsaWRhdGVGb3JtRGF0YSgpOltzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWR7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudGVyZWREZXNjcmlwdGlvbiA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSArdGhpcy5wZW9wbGVJbnB1dC52YWx1ZTtcclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCB0aXRsZVZhbGlkYXRvciA6IFN0cmluZ1ZhbGlkdGFibGUgPSB7XHJcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgICAgICAgICBtaW5MZW5ndGg6IDMsXHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IDUwXHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBjb25zdCBkZXNjVmFsaWRhdG9yIDogU3RyaW5nVmFsaWR0YWJsZSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG1pbkxlbmd0aDogMTAsXHJcbiAgICAgICAgICAgICAgICBtYXhMZW5ndGg6IDEwMFxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAgICAgY29uc3QgcGVvcGxlVmFsaWRhdG9yIDogTnVtYmVyVmFsaWR0YWJsZSA9IHtcclxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGVudGVyZWRQZW9wbGUsXHJcbiAgICAgICAgICAgICAgICBtYXg6IDZcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgICAgIGlmKHRoaXMuaXNGb3JtVmFsaWQoW3RpdGxlVmFsaWRhdG9yLCBkZXNjVmFsaWRhdG9yLCBwZW9wbGVWYWxpZGF0b3JdKSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXB0aW9uLCArZW50ZXJlZFBlb3BsZV07XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBhbGVydChcIkZvcm0gbm90IHZhbGlkXCIpXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgcHJpdmF0ZSBpc0Zvcm1WYWxpZChpbnB1dDogW1N0cmluZ1ZhbGlkdGFibGUsIFN0cmluZ1ZhbGlkdGFibGUsIE51bWJlclZhbGlkdGFibGVdKTogYm9vbGVhbntcclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0LmV2ZXJ5KHZhbGlkYXRvciA9PiB2YWxpZGF0ZVZhbHVlKHZhbGlkYXRvcikpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHByaXZhdGUgY2xlYXJBbGwoKXtcclxuICAgICAgICAgICAgdGhpcy50aXRsZUlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLnBlb3BsZUlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfSIsIiAgICAgICAgXHJcbiAgICBleHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxle1xyXG4gICAgICAgIHJlcXVpcmVkOiBib29sZWFuXHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGludGVyZmFjZSBTdHJpbmdWYWxpZHRhYmxlIGV4dGVuZHMgVmFsaWRhdGFibGV7XHJcbiAgICAgICAgdmFsdWU6IHN0cmluZztcclxuICAgICAgICBtYXhMZW5ndGg/OiBudW1iZXI7XHJcbiAgICAgICAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgTnVtYmVyVmFsaWR0YWJsZSBleHRlbmRzIFZhbGlkYXRhYmxle1xyXG4gICAgICAgIHZhbHVlOiBudW1iZXI7XHJcbiAgICAgICAgbWF4PzogbnVtYmVyO1xyXG4gICAgICAgIG1pbj86IG51bWJlcjtcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVWYWx1ZSh2YWxpZGF0b3I6IFN0cmluZ1ZhbGlkdGFibGUgfCBOdW1iZXJWYWxpZHRhYmxlKXtcclxuICAgICAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcblxyXG4gICAgICAgIGlmKHZhbGlkYXRvci5yZXF1aXJlZCl7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRvci52YWx1ZS50b1N0cmluZygpLmxlbmd0aCAhPT0gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCdtYXhMZW5ndGgnIGluIHZhbGlkYXRvciAmJiB2YWxpZGF0b3IubWF4TGVuZ3RoICE9PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0b3IudmFsdWUudG9TdHJpbmcoKS5sZW5ndGggPCB2YWxpZGF0b3IubWF4TGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoJ21pbkxlbmd0aCcgaW4gdmFsaWRhdG9yICYmIHZhbGlkYXRvci5taW5MZW5ndGggIT09IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRvci52YWx1ZS50b1N0cmluZygpLmxlbmd0aCA+IHZhbGlkYXRvci5taW5MZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKCdtYXgnIGluIHZhbGlkYXRvciAmJiB2YWxpZGF0b3IubWF4ICE9PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0b3IudmFsdWUgPCB2YWxpZGF0b3IubWF4O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoJ21pbicgaW4gdmFsaWRhdG9yICYmIHZhbGlkYXRvci5taW4gIT09IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRvci52YWx1ZSA+IHZhbGlkYXRvci5taW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpc1ZhbGlkO1xyXG4gICAgfVxyXG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlXCI7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgYXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xyXG4gICAgZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxle1xyXG5cclxuICAgICAgICBnZXQgcGVyc29ucygpe1xyXG4gICAgICAgICAgICBpZih0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSByZXR1cm4gJzEgcGVyc29uJztcclxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcscHJpdmF0ZSBwcm9qZWN0OlByb2plY3Qpe1xyXG4gICAgICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcclxuICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBAYXV0b0JpbmRcclxuICAgICAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5wcm9qZWN0LmlkKTtcclxuICAgICAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgQGF1dG9CaW5kXHJcbiAgICAgICAgZHJhZ0VuZEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHJlbmRlckNvbnRlbnQoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC50aXRsZTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NnaW5lZCc7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdwJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LmRlc2NyaXB0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGNvbmZpZ3VyZSgpOnZvaWQge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzLmRyYWdFbmRIYW5kbGVyKTtcclxuICAgICAgICB9O1xyXG4gICAgfSIsIiAgIGltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2VcIjsgXHJcbiAgIGltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuICAgaW1wb3J0IHsgYXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xyXG4gICBpbXBvcnQgeyBEcm9wVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcclxuICAgaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3RcIjtcclxuICAgaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcclxuICAgaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xyXG4gICAgZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBEcm9wVGFyZ2V0e1xyXG5cclxuICAgICAgICBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKXtcclxuICAgICAgICAgICAgc3VwZXIoJ3Byb2plY3QtbGlzdCcsICdhcHAnLCBmYWxzZSwgYCR7dHlwZX0tcHJvamVjdHNgKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0c2A7XHJcbiAgICBcclxuICAgICAgICAgICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIEBhdXRvQmluZFxyXG4gICAgICAgIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgICAgIGlmKGV2ZW50LmRhdGFUcmFuc2ZlciAmJiBldmVudC5kYXRhVHJhbnNmZXIudHlwZXNbMF0gPT09ICd0ZXh0L3BsYWluJyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKSlcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhIGFzIEhUTUxVTGlzdEVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBsaXN0LmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgQGF1dG9CaW5kXHJcbiAgICAgICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0SUQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcclxuICAgIFxyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJvamVjdElELCB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BQ1RJVkUgOiBQcm9qZWN0U3RhdHVzLkZJTklTSEVEKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBAYXV0b0JpbmRcclxuICAgICAgICBkcmFnTGVhdmVIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAgICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGlzdC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICByZW5kZXJQcm9qZWN0cygpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdHNMaXN0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgICAgICBwcm9qZWN0c0xpc3QuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgIGZvcihjb25zdCBwcm9qZWN0IG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cyl7XHJcbiAgICAgICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0ocHJvamVjdHNMaXN0LmlkLCBwcm9qZWN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHJlbmRlckNvbnRlbnQoKXtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyAnIFByb2plY3RzJztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpO1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkUHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKHByb2plY3Q6IFByb2plY3QpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLnR5cGUgPT09ICdhY3RpdmUnKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2plY3Quc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFDVElWRTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb2plY3Quc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZJTklTSEVEO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IGZpbHRlcmVkUHJvamVjdHM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSIsImltcG9ydCB7IFByb2plY3RJbnB1dCB9IGZyb20gXCIuL2NvbXBvbmVudHMvdXNlcklucHV0XCI7XHJcbmltcG9ydCB7IFByb2plY3RMaXN0IH0gZnJvbSBcIi4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3RcIjtcclxuXHJcbm5ldyBQcm9qZWN0SW5wdXQoKTtcclxubmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcclxubmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpOyJdLCJuYW1lcyI6WyJQcm9qZWN0U3RhdHVzIiwidGVtcElkIiwiaG9zdElkIiwiaXNBZnRlclN0YXJ0IiwiZWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImVsZW1lbnQiLCJpbXBvcnRUZW1wbGF0ZUNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImF0dGFjaFRlbXBsYXRlRWxlbWVudCIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiYXV0b0JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJ2YWx1ZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiaWQiLCJNYXRoIiwicmFuZG9tIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwicHJvamVjdFN0YXRlIiwicHJvamVjdHMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiUHJvamVjdFN0YXRlIiwiYWRkUHJvamVjdCIsImRlc2MiLCJuZXdQcm9qZWN0IiwiUHJvamVjdCIsIkFDVElWRSIsInB1c2giLCJ1cGRhdGVMaXN0ZW5lcnMiLCJsaXN0ZW5lcnMiLCJsaXN0ZW5lciIsInNsaWNlIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SUQiLCJuZXdTdGF0dXMiLCJwcm9qZWN0IiwiZmlsdGVyIiwicHJvaiIsImFkZExpc3RlbmVyIiwidGl0bGVJbnB1dCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0IiwicGVvcGxlSW5wdXQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VtYml0SGFuZGxlciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VyRGF0YSIsInZhbGlkYXRlRm9ybURhdGEiLCJBcnJheSIsImlzQXJyYXkiLCJjbGVhckFsbCIsInJlbmRlckNvbnRlbnQiLCJlbnRlcmVkVGl0bGUiLCJ0cmltIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsInRpdGxlVmFsaWRhdG9yIiwicmVxdWlyZWQiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJkZXNjVmFsaWRhdG9yIiwicGVvcGxlVmFsaWRhdG9yIiwibWF4IiwiaXNGb3JtVmFsaWQiLCJhbGVydCIsImlucHV0IiwiZXZlcnkiLCJ2YWxpZGF0b3IiLCJpc1ZhbGlkIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibWluIiwidmFsaWRhdGVWYWx1ZSIsIkNvbXBvbmVudCIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwidGV4dENvbnRlbnQiLCJwZXJzb25zIiwidHlwZSIsImFzc2lnbmVkUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJ0eXBlcyIsImNvbnNvbGUiLCJsb2ciLCJnZXREYXRhIiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJGSU5JU0hFRCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJyZW5kZXJQcm9qZWN0cyIsInByb2plY3RzTGlzdCIsImlubmVySFRNTCIsIlByb2plY3RJdGVtIiwidG9VcHBlckNhc2UiLCJmaWx0ZXJlZFByb2plY3RzIiwiUHJvamVjdElucHV0IiwiUHJvamVjdExpc3QiXSwic291cmNlUm9vdCI6IiJ9